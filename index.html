<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Toxicity Detector â€” Dashboard</title>
    <link rel="stylesheet" href="/static/style.css" />
    <!-- Optional: simple icon from fontawesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
      .status-grid {
        display: flex;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
      }
      .status-box-blue {
        flex: 1;
        min-width: 200px;
        padding: 15px;
        background: #f8fafc;
        border-radius: 8px;
        border-left: 4px solid #3b82f6;
      }
      .status-box-green {
        flex: 1;
        min-width: 200px;
        padding: 15px;
        background: #f8fafc;
        border-radius: 8px;
        border-left: 4px solid #10b981;
      }
      .status-label {
        font-size: 12px;
        color: #64748b;
        margin-bottom: 5px;
      }
      .status-value {
        font-size: 18px;
        font-weight: 600;
        color: #64748b;
      }
      .status-value-dark {
        font-size: 18px;
        font-weight: 600;
        color: #0f172a;
      }
      .btn-flex-group {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
      }
      .btn-green {
        background: #10b981;
      }
      .btn-red {
        background: #ef4444;
      }
      .btn-indigo {
        background: #6366f1;
        text-decoration: none;
        color: white;
        pointer-events: none;
        opacity: 0.5;
      }
      .btn-orange {
        background: #f97316;
        text-decoration: none;
        color: white;
      }
      .btn-ghost-refresh {
        margin-left: auto;
      }
      .btn-ghost-orange {
        border-color: #f97316;
        color: #f97316;
      }
      .result-hidden {
        margin-top: 15px;
        display: none;
      }
      .info-box {
        margin-top: 20px;
        padding: 15px;
        background: #fffbeb;
        border-radius: 8px;
        border: 1px solid #fbbf24;
      }
      .info-flex {
        display: flex;
        align-items: start;
        gap: 10px;
      }
      .info-icon {
        color: #f59e0b;
        margin-top: 3px;
      }
      .info-content {
        flex: 1;
      }
      .info-title {
        color: #92400e;
      }
      .info-text {
        margin: 5px 0 0 0;
        color: #78350f;
        font-size: 14px;
      }
      .info-link {
        color: #f97316;
        font-weight: 600;
      }
      .result-margin {
        margin-top: 15px;
      }
      .btn-purple {
        background: #8b5cf6;
      }
      .suggestions-hidden {
        display: none;
        margin-top: 20px;
        padding: 20px;
        background: #f0f9ff;
        border-radius: 8px;
        border: 2px solid #3b82f6;
      }
      .suggestions-title {
        margin-top: 0;
        color: #1e40af;
      }
    </style>
  </head>
  <body>
    <header class="topbar">
      <div class="brand">Toxicity Analyzer</div>
      <nav>
        <a href="/" class="active"><i class="fas fa-home"></i> Home</a>
        <a href="/chat-analyzer"><i class="fas fa-comment"></i> Chat Analyzer</a>
        <a href="/live-dashboard"><i class="fas fa-chart-pie"></i> Live Dashboard</a>
        <a href="/dataset-analyzer"><i class="fas fa-database"></i> Dataset Analyzer</a>
        <a href="/comparison"><i class="fas fa-balance-scale"></i> Comparison</a>
        <a href="/analytics"><i class="fas fa-chart-line"></i> Analytics</a>
        <a href="/batch"><i class="fas fa-layer-group"></i> Batch</a>
        <a href="/models"><i class="fas fa-brain"></i> Models</a>
        <a href="/help"><i class="fas fa-question-circle"></i> Help</a>
        <a href="/spark-proxy/" target="_blank" rel="noopener"><i class="fas fa-fire"></i> Spark UI</a>
      </nav>
    </header>

    <main class="container">
      <section id="hero">
        <h1>Toxicity Analysis Dashboard</h1>
        <p class="muted">Real-time message toxicity detection using intelligent keyword-based analysis</p>
      </section>

      <section id="spark-control" class="card">
        <h2>âš¡ Apache Spark Web UI Control</h2>
        <p class="muted">Monitor Spark jobs and cluster metrics in real-time</p>
        
        <div class="status-grid">
          <div class="status-box-blue">
            <div class="status-label">Status</div>
            <div id="spark-ui-status" class="status-value">
              <i class="fa fa-circle-notch fa-spin"></i> Checking...
            </div>
          </div>
          
          <div class="status-box-green">
            <div class="status-label">Web UI Port</div>
            <div class="status-value-dark">4040</div>
          </div>
        </div>
        
        <div class="actions btn-flex-group">
          <button id="start-spark-ui-btn" class="btn btn-green" disabled>
            <i class="fa fa-play"></i> Start Spark UI
          </button>
          <button id="stop-spark-ui-btn" class="btn btn-red" disabled>
            <i class="fa fa-stop"></i> Stop Spark UI
          </button>
          <a id="open-spark-ui-link" href="/spark-proxy/" target="_blank" rel="noopener" class="btn btn-indigo">
            <i class="fa fa-external-link-alt"></i> Open Spark UI
          </a>
          <a href="/spark-monitor" class="btn btn-orange">
            <i class="fa fa-fire"></i> Spark Monitor Page
          </a>
          <button id="refresh-spark-status-btn" class="btn ghost btn-ghost-refresh">
            <i class="fa fa-refresh"></i> Refresh Status
          </button>
        </div>
        
        <div id="spark-control-result" class="result result-hidden"></div>
        
        <div class="info-box">
          <div class="info-flex">
            <i class="fa fa-info-circle info-icon"></i>
            <div class="info-content">
              <strong class="info-title">About Spark UI:</strong>
              <p class="info-text">
                The Spark Web UI provides detailed monitoring of jobs, stages, and executors. 
                Visit the <a href="/spark-monitor" class="info-link">Spark Monitor Page</a> 
                for a fully integrated monitoring experience with embedded UI and controls.
              </p>
            </div>
          </div>
        </div>
      </section>

      <section id="spark-jobs" class="card">
        <h2>ðŸ”¥ Spark Data Processing</h2>
        <p class="muted">Run distributed data processing and model training jobs</p>
        <div class="actions btn-flex-group">
          <button id="run-spark-direct-btn" class="btn btn-orange"><i class="fa fa-bolt"></i> Run Direct Spark Job</button>
          <button id="run-spark-btn" class="btn ghost btn-ghost-orange"><i class="fa fa-play"></i> Run Background Job</button>
          <button id="train-model-btn" class="btn btn-green"><i class="fa fa-graduation-cap"></i> Train Model</button>
        </div>
        <div id="spark-result" class="result result-margin"></div>
      </section>

      <section id="predict" class="card">
        <h2>ðŸ’¬ Message Toxicity Analyzer</h2>
        <textarea id="predict-text" rows="6" placeholder="Enter a message to analyze for toxic content..."></textarea>
        <div class="actions">
          <button id="predict-btn" class="btn primary"><i class="fa fa-bolt"></i> Analyze Message</button>
          <button id="suggest-btn" class="btn btn-purple"><i class="fa fa-wand-magic-sparkles"></i> Get AI Suggestions</button>
        </div>
        <div id="predict-result" class="result"></div>
        <div id="risk-indicator" class="result-margin"></div>
        <div id="suggestions-panel" class="suggestions-hidden">
          <h3 class="suggestions-title"><i class="fa fa-lightbulb"></i> AI-Powered Suggestions</h3>
          <div id="suggestions-content"></div>
        </div>
      </section>
    </main>

    <footer class="footer muted">Real-time toxicity analysis powered by keyword detection</footer>

    <script src="/static/app.js"></script>
  </body>
</html>